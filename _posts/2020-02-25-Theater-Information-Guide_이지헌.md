---
layout: post
title: "Theater Information Guide - 이지헌"
date: 2020-02-25 15:30:00 +0300
tags: Python, Crawling, Bootstrap, Mysql, Django, ajax, AWS
category: 2019 Winter Course for Undergraduate Students
author: leejiheon
math: false
published: true
comments: true
---


이 포스팅은 2019 Winter Course for Undergraduate Students를 통하여 주차별로 학습하고 진행한 프로젝트 과정을 정리 및 최종 코드를 업로드 한 내용입니다.


## 2019 Winter Course for Undergraduate Students

주차별로 학습한 내용은 다음과 같습니다.

### 1주차 Linux Bootcamp, Git & Github
- [생활코딩 리눅스 강좌](https://www.inflearn.com/course/%EC%83%9D%ED%99%9C%EC%BD%94%EB%94%A9-%EB%A6%AC%EB%88%85%EC%8A%A4-%EA%B0%95%EC%A2%8C), 생활코딩, 2017
- [리눅스 커맨드라인 툴](https://www.inflearn.com/course/command-line/), 인프런, 2019
- [지옥에서 온 Git](https://www.inflearn.com/course/%EC%A7%80%EC%98%A5%EC%97%90%EC%84%9C-%EC%98%A8-git#curriculum), 생활코딩, 2018
- [버전 관리 시스템 git](https://www.inflearn.com/course/git-2#), 생활코딩, 2018
- [Git과 Github](https://www.inflearn.com/course/git-and-github#), 생활코딩, 2018

### 2주차 Crawling with Python
-  [파이썬입문과 크롤링기초 부트캠프](https://www.inflearn.com/course/Python-crawling-basic), 인프런, 2019
- [업무 자동화를 위한 파이썬 pyautogui, beautifulsoup 크롤링 기초](https://www.inflearn.com/course/%EC%97%85%EB%AC%B4%EC%9E%90%EB%8F%99%ED%99%94-%ED%8C%8C%EC%9D%B4%EC%8D%AC-pyautogui-%ED%81%AC%EB%A1%A4%EB%A7%81%EA%B8%B0%EC%B4%88#), 인프런, 2019
- [현존 최강 크롤링 기술: Scrapy와 Selenium 정복](https://www.inflearn.com/course/Crawling-Scrapy-Selenium#), 인프런, 2019


### 3주차 Web Bootcamp
- [컴퓨터, 웹, 코딩, 프로그래밍의 시작 - Web1](https://www.inflearn.com/course/%EC%BB%B4%ED%93%A8%ED%84%B0-%EC%9B%B9-%EC%BD%94%EB%94%A9-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EC%8B%9C%EC%9E%91-web-1), 생활코딩, 2018
- [WEB2 - CSS](https://www.inflearn.com/course/%EC%83%9D%ED%99%9C%EC%BD%94%EB%94%A9%EC%9D%98-web2%EC%8B%9C%EB%A6%AC%EC%A6%88), 생활코딩, 2018
- [WEB2 - JavaScript](https://www.inflearn.com/course/web2-javascript), 생활코딩, 2018
- [Bootstrap 4 & 3 Framework Tutorial](https://www.inflearn.com/course/bootstrap-2#), 인프런, 2018
- [나만의 포트폴리오 웹페이지 만들기](https://www.inflearn.com/course/%ED%8F%AC%ED%8A%B8%ED%8F%B4%EB%A6%AC%EC%98%A4#), 인프런, 2019
- [퍼블리셔 취업을 위해 제대로 배워보는 html과 css, 그리고 웹표준](https://www.inflearn.com/course/html-css-webazit), 인프런, 2018

### 4주차 Database Bootcamp
- [DATABASE 1&2 - MySQL](https://www.inflearn.com/course/database-2-mysql-%EA%B0%95%EC%A2%8C), 생활코딩, 2018
- [SQL/DB(MySQL) 기본부터 파이썬/데이터분석 활용까지!](https://www.inflearn.com/course/SQL-DB-MYSQL-%ED%8C%8C%EC%9D%B4%EC%8D%AC-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B6%84%EC%84%9D), 인프런, 2019

### 5주차 Django, IDE
- [파이썬으로 장고(Django) 공략하기: 입문](https://www.inflearn.com/course/django-course#), 인프런, 2019
- [Django Mini project BEST 3](https://www.inflearn.com/course/Django-%EB%AF%B8%EB%8B%88%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EA%B0%95%EC%A2%8C), 인프런, 2019
- [내 손으로 만드는 Django 2.x 인스타그램 클론 강의](https://www.inflearn.com/course/%EC%9E%A5%EA%B3%A0-%EC%9D%B8%EC%8A%A4%ED%83%80%EA%B7%B8%EB%9E%A8-%ED%81%B4%EB%A1%A0#), 인프런, 2019
- [쉽게 배워보는 파이참(PyCharm) 핵심 가이드](https://www.inflearn.com/course/pycharm-guide), 인프런, 2019

### 6주차 AWS Bootcamp
- [AWS (아마존 웹서비스) 가입부터 활용까지](https://www.inflearn.com/course/aws-%EC%95%84%EB%A7%88%EC%A1%B4-%EC%9B%B9%EC%84%9C%EB%B9%84%EC%8A%A4-%EA%B0%80%EC%9E%85%EB%B6%80%ED%84%B0-%ED%99%9C%EC%9A%A9%EA%B9%8C%EC%A7%80), 생활코딩, 2016
- [진짜 입문자를 위한 클라우드와 AWS](https://www.inflearn.com/course/aws-starter), 인프런, 2019

## 마일스톤 일정

마일스톤 일정을 계획하고 각 기간에 따라 정의한 산출물이 나오도록 하였습니다.

일정|산출물|기간
----|----|----
[Linux Bootcamp, Git & Github](https://github.com/Jiheon-Lee/teamlab_2019_winter/tree/master/Week_1)|Github 페이지 형성 후 README.md에 프로젝트 명과 기간 등 필요 내용 추가|2020.01.02 ~ 2020.01.08
[Crawling with Python](https://github.com/Jiheon-Lee/teamlab_2019_winter/tree/master/Week_2)|프로젝트에 필요한 데이터 수집을 위한 크롤링코드를 작성하고 데이터는 Excel, csv 파일 등등으로 저장|2020.01.09 ~ 2020.01.15
[Web Bootcamp](https://github.com/Jiheon-Lee/teamlab_2019_winter/tree/master/Week_3)|html, css, JavaScript를 학습하고 Bootstrap, jQuery를 이용하여 웹 Front-end 제작|2020.01.16 ~ 2020.01.22
[Database Bootcamp](https://github.com/Jiheon-Lee/teamlab_2019_winter/tree/master/Week_4)|Mysql을 이용해 데이터를 Database화|2020.01.23 ~ 2020.01.29
[Django](https://github.com/Jiheon-Lee/teamlab_2019_winter/tree/master/Week_5)|Django로 이전에 만들었던 Database와 Front-end 연결|2020.01.30 ~ 2020.02.05
[AWS Bootcamp](https://github.com/Jiheon-Lee/teamlab_2019_winter/tree/master/Week_6)|AWS로 만들었던 웹 서비스 시스템을 배포|2020.02.06 ~ 2020.02.12
발표|간단한 ppt 등을 이용하여 본인이 만든 시스템 소개하기|2020.02.13 ~ 2020.02.19

## 프로젝트 진행 과정

1. 먼저 프로젝트에 필요한 데이터를 수집하기 위해 Python으로 Crawling 코드를 작성합니다. 업무 자동화를 위해 Selenium을 사용합니다. 데이터는 pandas를 활용하여 Dataframe을 생성하고 csv 파일로 저장합니다.

> 네이버(Naver) 연극 정보

![Naver_theater](https://user-images.githubusercontent.com/48443734/72893751-32196780-3d5d-11ea-9ec3-6b5fa24a3409.PNG)

### Crawling with python Code

```python
from urllib.parse import quote_plus    # 한글 텍스트를 퍼센트 인코딩으로 변환
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait   # 해당 태그를 기다림
from selenium.webdriver.support import expected_conditions as EC
from selenium.common.exceptions import TimeoutException    # 태그가 없는 예외 처리
import time
import pandas as pd

_input = input('''-월--일, -월, 이번주, 이번주말 중 선택하여 입력해주세요.
                                 (-은 숫자 입력, 이번년도만 가능) : ''')
user_input = quote_plus(_input)

url = f'https://search.naver.com/search.naver?where=nexearch&sm=tab_etc&query={user_input}%20%EC%97%B0%EA%B7%B9%20%EA%B3%B5%EC%97%B0'
chromedriver = 'C:/Users/LeeJiheon/Desktop/가천대학교/TEAMLAB/2019_winter_study/2주차/crawling/chromedriver'

options = webdriver.ChromeOptions()
options.add_argument('headless')    # 웹 브라우저를 띄우지 않는 headlss chrome 옵션 적용
options.add_argument('disable-gpu')    # GPU 사용 안함
options.add_argument('lang=ko_KR')    # 언어 설정
driver = webdriver.Chrome(chromedriver, options=options)

driver.get(url)

try:    # 정상 처리
    element = WebDriverWait(driver, 3).until(
        EC.presence_of_element_located((By.CLASS_NAME, 'list_title'))
    )    # 해당 태그 존재 여부를 확인하기까지 3초 기다림
    theater_list = []
    pageNum = int(driver.find_element_by_class_name('_totalCount').text)
    count = 0

    for i in range(1, pageNum):
        theater_data = driver.find_elements_by_class_name('list_title')
        img_data = driver.find_elements_by_class_name('list_thumb')

        for k in theater_data:
            theater_list.append(k.text.split('\n'))

        for j in img_data:
            count += 1
            j.screenshot(f'img/{count}.png')

        driver.find_element_by_xpath("//a[@class='btn_page_next _btnNext on']").click()
        time.sleep(2)

except TimeoutException:    # 예외 처리
    print('해당 페이지에 연극 정보가 존재하지 않습니다.')

finally:    # 정상, 예외 둘 중 하나여도 반드시 실행
    driver.quit()

for i in range(len(theater_list)):
    theater_list[i].append(theater_list[i][1].split('~')[0])
    theater_list[i].append(theater_list[i][1].split('~')[1])

for i in range(len(theater_list)):
    if theater_list[i][4] == '오픈런':
        theater_list[i][4] = '50.01.01.'
        theater_list[i].append('True')
    else:
        theater_list[i].append('False')

theater_df = pd.DataFrame(theater_list,
                          columns=['연극명', '기간', '장소', '개막일', '폐막일', '오픈런'])
theater_df.index = theater_df.index + 1    # 인덱스 초기값 1로 변경
theater_df['개막일'] = pd.to_datetime(theater_df['개막일'], format='%y.%m.%d.')
theater_df['폐막일'] = pd.to_datetime(theater_df['폐막일'], format='%y.%m.%d.')
theater_df.to_csv(f'theater_{_input}_df.csv', mode='w', encoding='utf-8-sig',
                   header=True, index=True)

print('웹 크롤링이 완료되었습니다.')
```

<br>

- **Theater DataFrame**<br>
![Theater DataFrame](https://user-images.githubusercontent.com/48443734/72877924-48afc680-3d3d-11ea-8e88-828df67bf9a2.png)

<br>

- **Theater CSV**<br>
![Theater CSV](https://user-images.githubusercontent.com/48443734/72878495-6598c980-3d3e-11ea-8628-0617b17d7467.PNG)

<br>

- **Theater IMG**<br>
![Theater IMG](https://user-images.githubusercontent.com/48443734/73162391-074e5b00-4131-11ea-9efa-cd26b27ab940.PNG)

<br>

**최저가 연극 관람 티켓 구매 정보 Crawling**
```python
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
import time
import pandas as pd

theater_df = pd.read_csv('theater_df.csv')

chromedriver = 'C:/Users/LeeJiheon/Desktop/가천대학교/TEAMLAB/2019_winter_study/2주차/crawling/chromedriver'
driver = webdriver.Chrome(chromedriver)

driver.get('https://shopping.naver.com')

search_word = theater_df['연극명'].values.tolist()

shop_list = []
for i in search_word:
    search_input = driver.find_element_by_xpath('//*[@id="autocompleteWrapper"]/input[1]')
    search_input.clear()
    search_input.send_keys(i)
    search_click = driver.find_element_by_xpath('//*[@id="autocompleteWrapper"]/a[2]')
    search_click.send_keys(Keys.RETURN)
    elem = driver.find_element_by_xpath('//*[@id="_search_list"]/div[1]/ul/li[1]/div[2]/div/a')
    purchase_name = elem.text
    purchase_link = elem.get_attribute('href')
    elem = driver.find_element_by_css_selector('#_search_list > div.search_list.basis > ul > li:nth-child(1) > div.info > span.price > em > span.num._price_reload')
    purchase_price = elem.text
    shop_list.append([purchase_name, purchase_price, purchase_link])
    time.sleep(2)

driver.quit()

shop_df = pd.DataFrame(shop_list,
                       columns=['Title', 'Price', 'link'])
shop_df.to_csv('shop_df.csv', mode='w', encoding='utf-8-sig',
               header=True, index=True)

print('웹 크롤링이 완료되었습니다.')
```

<br>

- **Shop DataFrame**<br>
![Theater DataFrame](https://user-images.githubusercontent.com/48443734/73162389-061d2e00-4131-11ea-8cfc-e945bce21f35.png)

<br>

**Theater_Detail_Info Crawling**
```python
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
import pandas as pd

theater_df = pd.read_csv('theater_df.csv')
search_word = theater_df['연극명'].values.tolist()

chromedriver = '/home/leejiheon/workspace/crawling/chromedriver'
driver = webdriver.Chrome(chromedriver)

driver.get('https://search.naver.com/search.naver?sm=top_hty&fbm=1&ie=utf8&query=%EA%B7%B9%EC%A0%81%EC%9D%B8%ED%95%98%EB%A3%BB%EB%B0%A4')

detail_list = []
for i in search_word:
    search_input = driver.find_element_by_xpath('//*[@id="nx_query"]')
    search_input.clear()
    search_input.send_keys(i)
    search_click = driver.find_element_by_xpath('//*[@id="nx_search_form"]/fieldset/button')
    search_click.send_keys(Keys.RETURN)
    elem = driver.find_element_by_class_name('item_list')
    info = elem.text
    info_list = info.strip().split('\n')
    age = info_list[2]
    time = info_list[4]
    discription = info_list[-1]
    detail_list.append([i, age, time, discription])

driver.quit()

detail_df = pd.DataFrame(detail_list,
                         columns=['연극명', '관람등급', '공연시간', '내용'])
detail_df.to_csv('detail_df.csv', mode='w', encoding='utf-8-sig', header=True, index=True)

print('웹 크롤링이 완료되었습니다.')
```
<br>

- **Theater_Detail DataFrame**<br>
![Theater_Detail DataFrame](https://user-images.githubusercontent.com/48443734/73242868-75eeef80-41e9-11ea-8d27-9c4ef4117880.png)

<br>

2. Bootstrap을 활용하여 웹 Front-end 제작합니다.
> https://github.com/Jiheon-Lee/teamlab_2019_winter/tree/master/Week_3

![index](https://user-images.githubusercontent.com/48443734/73118522-a724b100-3f98-11ea-917b-df5f9773262b.PNG)
![index_under](https://user-images.githubusercontent.com/48443734/73118523-a7bd4780-3f98-11ea-90d5-97f1392a6202.PNG)
![theater](https://user-images.githubusercontent.com/48443734/73118524-a7bd4780-3f98-11ea-8b8c-5d909d14874c.PNG)

<br>

3. Mysql을 이용하여 Web Crawling으로 수집한 데이터를 Database화 합니다.

## Database create code

```sql
CREATE DATABASE tig;
USE tig;

CREATE TABLE theaters(
    TheaterID int not null auto_increment,
    TheaterName varchar(50) not null,
    Period varchar(50) not null,
    Place varchar(50) not null,
    OpeningDay date null,
    ClosingDay date null,
    OpenRun varchar(50) default null,
    primary key(TheaterID)
);

CREATE TABLE theaters_details(
    TheaterID int not null,
    ViewingAge varchar(50) null,
    PerformanceTime varchar(50) null,
    Descriptions varchar(255) null,
    Price decimal(7) null,
    ShopTitle varchar(50) null,
    ShopLink longtext null,
    Image varchar(255) null, # Image File 경로 저장
    foreign key(TheaterID)
      references theaters(TheaterID) on delete cascade on update cascade
);

CREATE TABLE users(
    UserID int not null auto_increment,
    UserName varchar(50) not null,
    primary key(UserID)
);

CREATE TABLE comments(
    CommentID int not null auto_increment,
    UserID int not null,
    TheaterID int not null,
    Content varchar(255) null,
    Reply varchar(255) null,
    Likes int null,
    Image blob null,
    primary key(CommentID),
    foreign key(UserID)
      references users(UserID) on delete cascade on update cascade,
    foreign key(TheaterID)
      references theaters(TheaterID) on delete cascade on update cascade
);
```

<br>

- **Database ERD**

<br>

![tig_database_ERD](https://user-images.githubusercontent.com/48443734/73377954-35839480-4303-11ea-8d51-e2750ffd0d68.png)

<br>

- **Theaters Table**

<br>

![Theaters Table](https://user-images.githubusercontent.com/48443734/73336131-5b357d00-42b4-11ea-8dc6-bf4536152db6.png)

<br>

- **Theaters_details Table**

<br>

![Theaters_details](https://user-images.githubusercontent.com/48443734/73336132-5bce1380-42b4-11ea-876b-cad2a2dad0c7.png)

<br>

4. Django로 Mysql과 연동하여 Database와 Front-end를 연결 후 Django Form을 이용하여 검색 기능을 구현하고 Pagination, 인기순, 최신순과 같은 각 기능들을 구현하기 위한 jQuery ajax 코드를 작성합니다. 특정 기능을 구현한 코드만 업로드했으며 전체적인 코드는 아래 링크에서 확인할 수 있습니다.
> https://github.com/Jiheon-Lee/teamlab_2019_winter/tree/master/Week_5

## Django project code

- **change_option, change_page**

> views

```Python
from Theater_Information_Guide.models import TheatersDetails
from django.http import JsonResponse


def change_option(request):
    option = request.GET['option']

    if option == 'popular-order':
        theaters_data = TheatersDetails.objects.select_related().all()[:6]
    elif option == 'latest-order':
        theaters_data = TheatersDetails.objects.select_related().all().order_by('-theaterid__openingday')[:6]
    elif option == 'name-order':
        theaters_data = TheatersDetails.objects.select_related().all().order_by('theaterid__theatername')[:6]

    data = []
    for i in theaters_data:
        data_dict = dict()
        data_dict['id'] = i.theaterid.theaterid
        data_dict['name'] = i.theaterid.theatername
        data_dict['price'] = i.price
        data_dict['period'] = i.theaterid.period
        data_dict['place'] = i.theaterid.place
        data_dict['image'] = i.image
        data.append(data_dict)

    context = {
        'theater_data': data
    }
    return JsonResponse(context)


def change_page(request):
    page = request.GET['page']
    option = request.GET['option']

    if option == 'popular-order':
        theaters_data = TheatersDetails.objects.select_related().all()
        if page == 'page-01':
            theaters_data = theaters_data[:6]
        elif page == 'page-02':
            theaters_data = theaters_data[6:12]
        elif page == 'page-03':
            theaters_data = theaters_data[12:16]
    elif option == 'latest-order':
        theaters_data = TheatersDetails.objects.select_related().all().order_by('-theaterid__openingday')
        if page == 'page-01':
            theaters_data = theaters_data[:6]
        elif page == 'page-02':
            theaters_data = theaters_data[6:12]
        elif page == 'page-03':
            theaters_data = theaters_data[12:16]
    elif option == 'name-order':
        theaters_data = TheatersDetails.objects.select_related().all().order_by('theaterid__theatername')
        if page == 'page-01':
            theaters_data = theaters_data[:6]
        elif page == 'page-02':
            theaters_data = theaters_data[6:12]
        elif page == 'page-03':
            theaters_data = theaters_data[12:16]

    data = []
    for i in theaters_data:
        data_dict = dict()
        data_dict['id'] = i.theaterid.theaterid
        data_dict['name'] = i.theaterid.theatername
        data_dict['price'] = i.price
        data_dict['period'] = i.theaterid.period
        data_dict['place'] = i.theaterid.place
        data_dict['image'] = i.image
        data.append(data_dict)

    context = {
        'theater_data': data
    }
    return JsonResponse(context)
```

<br>

> jQuery ajax

```javascript
$(document).ready(function () {
    $('#sort-select').change(function () {
        var option = $("#sort-select option:selected").val();
        var active = $("ul>li");
        active.removeClass('active');
        $('#page-01').addClass('active');
        $.ajax({
            url: '/change_option/',
            data: {option: option},
            success: function (data) {
                var opt_data = data.theater_data;
                var num = data.theater_data.length;
                $("div").remove("#theater_body");
                for (var i = 0; i < num; i++) {
                    $("#change-option").append(
                        '<div class="col-md-4" id="theater_body">' +
                        '<div class="card-box-a card-shadow">' +
                        '<div class="img-box-a">' +
                        '<img src="' +
                        '/static/'
                        + opt_data[i].image +
                        '" alt="" class="img-a img-fluid">' +
                        '</div>' +
                        '<div class="card-overlay">' +
                        '<div class="card-overlay-a-content">' +
                        '<div class="card-header-a">' +
                        '<h2 class="card-title-a">' +
                        '<a>' + opt_data[i].id + '위' +
                        '<br/>' + opt_data[i].name + '</a>' +
                        '</h2>' +
                        '</div>' +
                        '<div class="card-body-a">' +
                        '<div class="price-box d-flex">' +
                        '<span class="price-a">Price | $ ' + opt_data[i].price + '</span>' +
                        '</div>' +
                        '<a href="/theaters/' +
                        opt_data[i].id +
                        '/" class="link-a">Click here to view' +
                        '<span class="ion-ios-arrow-forward"></span>' +
                        '</a>' +
                        '</div>' +
                        '<div class="card-footer-a">' +
                        '<ul class="card-info d-flex justify-content-around">' +
                        '<li>' +
                        '<h4 class="card-info-title">기간</h4>' +
                        '<span>' + opt_data[i].period + '</span>' +
                        '</li>' +
                        '<li>' +
                        '<h4 class="card-info-title">장소</h4>' +
                        '<span>' + opt_data[i].place + '</span>' +
                        '</li>' +
                        '</ul>' +
                        '</div>' +
                        '</div>' +
                        '</div>' +
                        '</div>' +
                        '</div>'
                    );
                }
            }
        });
    });
});

$(document).ready(function () {
    $(".page-item").on("click", function () {

        var pre_data = $(".page-item.active ").attr("id");
        var cli_data = $(this).attr("id");

        var option = $("#sort-select option:selected").val();
        var active = $("ul>li");
        active.removeClass('active');

        if (cli_data == "page-previous") {
            if (pre_data == "page-03") {
                var page = "page-02"
            } else {
                var page = "page-01"
            }
        } else if (cli_data == "page-next") {
            if (pre_data == "page-01"
            ) {
                var page = "page-02";
            } else {
                var page = "page-03";
            }
        } else {
            var page = cli_data;
        }
        $("#" + page).addClass('active');


        $.ajax({
            url: '/change_page/',
            data: {
                page: page,
                option: option,
            },
            success: function (data) {
                var opt_data = data.theater_data;
                var num = data.theater_data.length;
                $("div").remove("#theater_body");
                for (var i = 0; i < num; i++) {
                    $("#change-option").append(
                        '<div class="col-md-4" id="theater_body">' +
                        '<div class="card-box-a card-shadow">' +
                        '<div class="img-box-a">' +
                        '<img src="' +
                        '/static/'
                        + opt_data[i].image +
                        '" alt="" class="img-a img-fluid">' +
                        '</div>' +
                        '<div class="card-overlay">' +
                        '<div class="card-overlay-a-content">' +
                        '<div class="card-header-a">' +
                        '<h2 class="card-title-a">' +
                        '<a>' + opt_data[i].id + '위' +
                        '<br/>' + opt_data[i].name + '</a>' +
                        '</h2>' +
                        '</div>' +
                        '<div class="card-body-a">' +
                        '<div class="price-box d-flex">' +
                        '<span class="price-a">Price | $ ' + opt_data[i].price + '</span>' +
                        '</div>' +
                        '<a href="/theaters/' +
                        opt_data[i].id +
                        '/" class="link-a">Click here to view' +
                        '<span class="ion-ios-arrow-forward"></span>' +
                        '</a>' +
                        '</div>' +
                        '<div class="card-footer-a">' +
                        '<ul class="card-info d-flex justify-content-around">' +
                        '<li>' +
                        '<h4 class="card-info-title">기간</h4>' +
                        '<span>' + opt_data[i].period + '</span>' +
                        '</li>' +
                        '<li>' +
                        '<h4 class="card-info-title">장소</h4>' +
                        '<span>' + opt_data[i].place + '</span>' +
                        '</li>' +
                        '</ul>' +
                        '</div>' +
                        '</div>' +
                        '</div>' +
                        '</div>' +
                        '</div>'
                    );
                }
            }
        });
    });
});
```

<br>

- **Search**

> views

```Python
from django.shortcuts import render
from Theater_Information_Guide.models import TheatersDetails
from django.db.models import Q


def search(request):
    user_input = request.GET['user_input']
    location = request.GET['location']
    type = request.GET['type']

    theaters_data = TheatersDetails.objects.select_related().all()

    theaters_data = theaters_data.filter(
        Q(theaterid__theatername__icontains=user_input) &
        Q(theaterid__location__icontains=location) &
        Q(theaterid__openrun__icontains=type)
    )

    search_data = []
    for i in theaters_data:
        data_dict = dict()
        data_dict['id'] = i.theaterid.theaterid
        data_dict['name'] = i.theaterid.theatername
        data_dict['price'] = i.price
        data_dict['period'] = i.theaterid.period
        data_dict['place'] = i.theaterid.place
        data_dict['image'] = i.image
        search_data.append(data_dict)
    context = {
        'search_data': search_data
    }
    return render(request, "search.html", context)
```

<br>

- **urls**

```Python
from django.urls import path
from . import views


urlpatterns = [
    path('', views.index, name="index"),
    path('theaters/', views.theaters_index, name="theaters_index"),
    path('theaters/<int:pk>/', views.theaters_detail, name="theaters_detail"),
    path('developer/', views.developer, name="developer"),
    path('change_option/', views.change_option, name="change_option"),
    path('change_page/', views.change_page, name="change_page"),
    path('search/', views.search, name="search"),
]
```

<br>

5. AWS EC2를 이용하여 가상 컴퓨터 인스턴스를 생성하고 ssh를 사용하여 인스턴스에 접속 한 후 서버 환경 설정을 마치고 scp를 사용하여 완성한 장고 프로젝트를 서버 컴퓨터에 업로드합니다.

<pre>$ ssh -i ~/.ssh/EC2-TIG.pem ubuntu@EC2 퍼블릭 DNS 주소</pre>
<pre>$ scp -i ~/.ssh/EC2-TIG.pem -r /home/leejiheon/workspace/tig ubuntu@퍼블릭 DNS 주소:/srv/</pre>

![AWS Instance](https://user-images.githubusercontent.com/48443734/74807987-29e92380-532d-11ea-88ea-f3d993f47b0d.png)

<br>

**http://ec2-54-180-113-171.ap-northeast-2.compute.amazonaws.com:8080/**

<br>

## 내용 정리

> https://github.com/Jiheon-Lee/teamlab_2019_winter

### Theater Information Guide 프로젝트

1. Theater Information Guide로 파이썬으로 웹 크롤링을 위한 코드를 작성
2. 수집한 데이터를 MYSQL을 이용하여 DB화
3. 여러 기능을 제공하는 시스템을 개발
4. Bootstrap으로 웹 Front-end를 구현
5. Django로 Database와 Front-end를 연결, jQuery(ajax) 코드 작성
6. AWS(아마존웹서비스) 서버를 이용하여 배포하는 것이 목표

**2020.01.02 ~ 2020.02.19**

<br>

### Theater Information Guide 기능

- Keyword와 Filter를 이용하여 연극에 대하여 원하는 정보를 검색 할 수 있습니다.
- 인기순, 관람등급, 공연시간, 기간, 장소, 내용 등 연극에 대하여 자세한 정보를 제공합니다.
- 연극 관람 티켓을 최저가로 구매할 수 있도록 최저가, 구매처 정보를 제공하고 도와드립니다.

<br>

개인으로 프로젝트를 진행하여 힘들었지만 학습한 내용을 바탕으로 실제로 직접 적용하며 데이터를 수집, 시스템을 설계, Database와 Web을 구현, AWS 배포까지 프로젝트를 진행할 수 있는 좋은 경험이었습니다. 아쉬웠던 부분은 기간이 짧아서 부족한 부분이 보였습니다. 이러한 부분은 이후에 더 깊게 학습하여 개선하도록 하겠습니다. 감사합니다.

